# Auto-Encoding Variational Bayes
- https://arxiv.org/abs/1312.6114
- [Submitted on 20 Dec 2013 (v1), last revised 1 May 2014 (this version, v10)]

---

## Abstract
We introduce a stochastic variational inference and learning algorithm that scales to large datasets and, under some mild differentiability conditions, even works in the intractable case
Our contributions
1) we show that a reparameterization of the variational lower bound yields a lower bound estimator that can be straightforwardly optimized using standard stochastic gradient methods.
2) we show that for i.i.d. datasets with continuous latent variables per datapoint, posterior inference can be made especially efficient by fitting an approximate inference model (also called a recognition model) to the intractable posterior using the proposed lower bound estimator.

## 1 Introduction
AEVB algorithm

## 2 Method
a lower bound estimator (a stochastic objective function) for a variety of directed graphical models with continuous latent variables.
- we have an i.i.d. dataset with latent variables per datapoint
- perform maximum likelihood (ML) or maximum a posteriori (MAP) inference on the (global) parameters, and variational inference on the latent variables.

### 2.1 Problem scenario
- some dataset X
- the data are generated by some random process, involving an unobserved continuous random variable z.
- The process consists of two steps:
1. a value z(i) is generated from some prior distribution p (z)
2. value x(i) is generated from some conditional distribution p (x|z).
- Unfortunately, a lot of this process is hidden from our view: the true parameters  as well as the values of the latent variables z(i) are unknown to us.

- we do not make the common simplifying assumptions about the marginal or posterior probabilities.
- we are here interested in a general algorithm that even works efficiently in the case of: Intractability(ë¯¸ë¶„ì„ í•  ìˆ˜ ì—†ìŒ), A large dataset

propose a solution
1. parameters theta : mimic the hidden random process and generate artificial data that resembles the real data
2. latent variable z : given an observed value x for a choice of parameters theta.
3. variable x : This allows us to perform all kinds of inference tasks where a prior over x is required

- q(z|x): an approximation to the intractable true posterior p(z|x) == probabilistic encoder,
- p(xjz) as a probabilistic decoder

### 2.2 The variational bound
The marginal likelihood is composed of a sum over the marginal likelihoods of individual datapoints 
L(;; x(i)) is called the (variational) lower bound on the marginal likelihood of datapoint i

### 2.3 The SGVB estimator and AEVB algorithm
The first term is (the KL divergence of the approximate posterior from the prior) acts as a regularizer, while the second term is a an expected negative reconstruction error.

### 2.4 The reparameterization trick
z be a continuous random variable
Z ~  q(zjx) be some conditional distribution.
we applied this trick to obtain a differentiable estimator of the variational lower bound.

## 3 Example: Variational Auto-Encoder

## 4 Related work

## 5 Experiments
The generative model (encoder) and variational approximation (decoder) 
the described encoder and decoder have an equal number of hidden units.

## 6 Conclusion
We have introduced a novel estimator of the variational lower bound, Stochastic Gradient VB (SGVB), for efficient approximate inference with continuous latent variables

---
---
---

# Auto-Encoding Variational Bayes
- https://arxiv.org/abs/1312.6114
- [Submitted on 20 Dec 2013 (v1), last revised 1 May 2014 (this version, v10)]

---

## Summary
**Auto-Encoding VB (AEVB) algorithm**
ë¯¸ë¶„í•  ìˆ˜ ì—†ëŠ” intractable posterior distributions í˜¹ì€ large datasetsì˜ ê²½ìš° íš¨ìœ¨ì ì¸ probabilistic ëª¨ë¸ì„ ì œì•ˆí•œë‹¤.
-  reparameterization ë°©ë²•ì„ ì‚¬ìš©í•´ì„œ ë¯¸ë¶„í•  ìˆ˜ ìˆë‹¤. (reparameterization of the variational lower bound yields a simple differentiable unbiased estimator of the lower bound)
- approximate inference model ì„ ì‚¬ìš©í•œë‹¤.

## Problem scenario
![image](https://user-images.githubusercontent.com/70581043/128625655-47c498ad-a319-4a9b-bda4-d98328e0dee4.png)
í›ˆë ¨í•  ë•Œì˜ ë¬¸ì œëŠ”  true parameter *theta*ì™€ latent variables *z*ë¥¼ ëª¨ë¥¸ë‹¤ëŠ” ê²ƒì´ë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ 3ê°€ì§€ë¥¼ ì œì•ˆí•œë‹¤.

1. parameter *theta* : hidden random processë¥¼ í‰ë‚´ë‚´ì–´ ì‹¤ì œ ë°ì´í„°ì™€ ë¹„ìŠ·í•œ ê°€ìƒì˜ ë°ì´í„°ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.
2. variable *z* : parameter *theta*ê°€ ì£¼ì–´ì¡Œì„ ë•Œ ê´€ì°°ë˜ëŠ” *x* ê°’ê³¼ ìœ ì‚¬í•œ latent variable
3. variable *x* :  ì´ë¯¸ì§€ ë””ë…¸ì´ì¦ˆ, super-resolutionì— í™œìš©ë  ìˆ˜ ìˆë‹¤.

ìœ„ ë¬¸ì œë¥¼ í’€ê¸° ìœ„í•´ì„œ ì‹¤ì œ ê°’ì¸ ![image](https://user-images.githubusercontent.com/70581043/128625906-9f35a63b-590a-4dfb-86b7-372aa52ae42a.png) ê³¼ ê·¼ì‚¬í•œ ![image](https://user-images.githubusercontent.com/70581043/128625901-a8b181a2-eea7-4df5-b83c-2d72e8f6a358.png) ì„ ì œì•ˆí•¨
- ![image](https://user-images.githubusercontent.com/70581043/128625937-e9aae80e-4285-4ecf-9033-1b3d0c463865.png) : probabilistic encoder
- ![image](https://user-images.githubusercontent.com/70581043/128625950-03897126-e109-4feb-bf90-f5235d49f40e.png) : probabilistic decoder

## The variational bound
![image](https://user-images.githubusercontent.com/70581043/128625987-37e61ee7-f1d3-4085-8368-e3605b7d914e.png)
ëª¨ë“  p_theta(x i) ì˜ í™•ë¥ ì€ â‘  ì‹¤ì œ ê°’ê³¼ ì–¼ë§ˆë‚˜ ê·¼ì‚¬í•œì§€ ê°’ â‘¡ ê°€ì¥ ìµœì €ì˜ í•œê³„ ê°€ëŠ¥ì„±ì„ ë‚˜íƒ€ë‚¸ë‹¤. 

## AEVB algorithm
- ![image](https://user-images.githubusercontent.com/70581043/128626112-93f10d16-7e4d-483a-88d0-279d0ebc03a0.png)
![image](https://user-images.githubusercontent.com/70581043/128626121-7befa035-e4dd-418a-ba86-9d8d6db14ea3.png) ì„ ë¯¸ë¶„í•  ìˆ˜ ìˆëŠ” ë³€í˜•ëœ í˜•íƒœ
- generic Stochastic Gradient Variational Bayes (SGVB) estimator
![image](https://user-images.githubusercontent.com/70581043/128626226-1b4eb37f-e6af-4ca0-8220-bf0f1cfa4cc5.png)
- second version of the SGVB estimator
![image](https://user-images.githubusercontent.com/70581043/128626247-41aa6bde-823e-44d4-bd0e-be56f6110f5f.png)
> - ì²«ë²ˆì§¸ ìˆ˜ì‹(KL divergence) : regularizer ê°™ì€ ì—­í• ì„ ìˆ˜í–‰í•¨
> - ë‘ë²ˆì§¸ ìˆ˜ì‹ : negative reconstruction error
- multiple datapoints from a dataset X with N datapoints
![image](https://user-images.githubusercontent.com/70581043/128626258-2a94d3fd-54cc-46fd-9ec3-76f5e5158253.png)

## The reparameterization trick
variational lower bound ì˜ ë¯¸ë¶„ê°’ì„ ì–»ì„ ìˆ˜ ìˆëŠ”ë° ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

---

ë­ë¼ê³  í•˜ëŠ”ê±´ì§€ ëª¨ë¥´ê² ,,,,, ì¶”ê°€ì ìœ¼ë¡œ ë‹¤ë¥¸ ì°¸ê³ ìë£Œë“¤ì„ ë³´ë©´ì„œ ì´í•´í•´ì•¼ê² ìŠµë‹ˆë‹¤..ğŸ˜­

---
ìš”ì•½í•˜ìë©´, ìš°ë¦¬ê°€ êµ¬í•˜ê³  ì‹¶ì€ ê²ƒì€ xì— ëŒ€í•œ í™•ë¥  ê°’ì´ë‹¤. ![image](https://user-images.githubusercontent.com/70581043/128833399-8fcef3b6-9a8b-49c6-b30c-4da331633ae5.png) ì´ë¥¼ êµ¬í•˜ê¸° ìœ„í•´ì„œ DKLì˜ ìµœì†Œê°’ì„ êµ¬í•´ì•¼ í•˜ëŠ” ë¬¸ì œê°€ ëœë‹¤. ì´ëŠ” ê³§ Lower boundì˜ ìµœëŒ“ê°’ì„ êµ¬í•˜ëŠ” ë¬¸ì œì™€ ë™ì¼í•˜ë‹¤. ìš°ë¦¬ëŠ” ì‹¤ì œ xê°’ê³¼ zê°’ì„ ëª¨ë¥´ê¸° ë•Œë¬¸ì— ì‹¤ì œ ê°’ê³¼ ê·¼ì‚¬í•œ ![image](https://user-images.githubusercontent.com/70581043/128833827-4cc847be-6e9d-4e9d-afb6-643712670df0.png) ì„ ì„¤ì •í•´ì¤€ë‹¤. ë˜í•œ ë¯¸ë¶„ì´ ê°€ëŠ¥í•˜ë„ë¡ reparameterization trickì„ ì‚¬ìš©í–ˆë‹¤. ì¦‰ zë¥¼ í•¨ìˆ˜ gë¡œ í‘œí˜„í•¨ìœ¼ë¡œì¨ (í‰ê· , ë¶„ì‚°)ì— ëŒ€í•´ ë¯¸ë¶„ì´ ê°€ëŠ¥í•˜ê²Œ ë°”ê¾¸ì—ˆë‹¤. ìµœì¢… loss functionì€ ë‹¤ìŒê³¼ ê°™ë‹¤ 
![image](https://user-images.githubusercontent.com/70581043/128834225-8fc5b457-f3a4-408f-b044-f7e836d9b231.png)


---
---
---
[ì¶”ê°€ ì •ë¦¬]

## ê¸°ë³¸ ê°œë…
**1. ì˜¤í† ì¸ì½”ë”**
![image](https://user-images.githubusercontent.com/70581043/128823841-efdd8a56-443b-4791-99a0-aedbd07bec26.png)
- ì˜¤í† ì¸ì½”ë”ëŠ” ê³ ì°¨ì›ì˜ ì…ë ¥ ë°ì´í„°(x)ë¥¼ ì €ì°¨ì›ì˜ ì ì¬ë³€ìˆ˜(latent variables; z)ë¡œ ì••ì¶•(=ì°¨ì›ì¶•ì†Œ)í•œ ë’¤, ë‹¤ì‹œ ì…ë ¥ ë°ì´í„°ì— ê°€ê¹Œìš´ ê³ ì°¨ì› ë°ì´í„°(xâ€™)ë¡œ ë³µì›í•˜ëŠ” êµ¬ì¡°ì˜ ëª¨ë¸ 
- ì••ì¶•í•˜ëŠ” ë¶€ë¶„ì„ encoder, ë³µì›í•˜ëŠ” ë¶€ë¶„ì„ decoder
- encoderë¥¼ í•˜ë©´ì„œ ë°ì´í„°ê°€ ê°€ì§„ ìˆ˜ì‹­, ìˆ˜ë°±ê°œ ë³€ìˆ˜ë¡œë¶€í„° ì¤‘ìš”í•œ ë³€ìˆ˜ë¥¼ ì¶”ì¶œí•¨
- decoderëŠ” ì •ë‹µ ë°ì´í„°ë¥¼ ì…ë ¥ ë°ì´í„°ë¡œ ì‚¬ìš©í•¨ ( Self-supervised learning )
- VAEì—ì„œëŠ” decoderë¥¼ ì‚¬ìš©í•´ì„œ ìƒˆ ë°ì´í„°ë¥¼ ë§Œë“¤ì–´ ë‚´ê¸° ë•Œë¬¸ì— ìƒì„± ëª¨ë¸ì˜ ìš©ë„ë¡œ ì‚¬ìš©ë¨

**2. Variational inference**
![image](https://user-images.githubusercontent.com/70581043/128824437-26a0f228-a178-4303-8f6c-8a1e60459f05.png)
ìœ„ì˜ ì‹ì„ ìµœì†Œí•˜í•˜ë©´,
![image](https://user-images.githubusercontent.com/70581043/128824519-6743ace8-b8b0-4c1e-82c2-d268f3b31e0b.png)
![image](https://user-images.githubusercontent.com/70581043/128824711-b98cfb47-b54b-4c5d-a13b-e801de4dd5b6.png)

- Variational inferenceëŠ”, ì–´ë–¤ ì‚¬í›„í™•ë¥  ì„ ì•Œê³  ì‹¶ì„ ë•Œ ì´ë¥¼ ê·¼ì‚¬(approximate)í•œ í™•ë¥ ë¶„í¬ë¥¼ ìƒì •í•œ ë’¤, ë‘ ë¶„í¬ ê°„ ì°¨ì´ë¥¼ ìˆ˜ì¹˜í™”í•œ KL divergenceë¥¼ ìµœì†Œí™”í•´ ê·¼ì‚¬ ë¶„í¬ë¥¼ êµ¬í•˜ëŠ” ì ‘ê·¼ë²•
-  â€˜Lower boundâ€™(ë˜ëŠ” â€˜ELBOâ€™)ë¥¼ ìµœëŒ€í™”í•˜ëŠ” ë¬¸ì œë¡œ êµ¬í•´ë„ ëœë‹¤.

**3. Variational ì˜¤í† ì¸ì½”ë”(VAE)**
![image](https://user-images.githubusercontent.com/70581043/128825034-03cf1d47-be22-4b55-8b53-2edc9ab301c0.png)
- VAEëŠ” 2ë²ˆì˜ Variational inferenceë¥¼ ì‚¬ìš©í•œ ì˜¤í† ì¸ì½”ë”
- xë¥¼ zì˜ approximation ë¶„í¬ì˜ í‰ê· , ë¶„ì‚° ë²¡í„°ë¡œ ì¸ì½”ë”©
ì†ì‹¤í•¨ìˆ˜
![image](https://user-images.githubusercontent.com/70581043/128825500-ee46ae27-5f22-4a61-a565-7dcaeaee1cc7.png)

4. 
## 1. Problem Suggestion 
![image](https://user-images.githubusercontent.com/70581043/128815836-96290485-a175-40a9-9d16-5ab18ccd697e.png)
VAEì—ì„œì˜ ëª©í‘œëŠ” posterior distribution ë¶„í¬ë¥¼ ì•Œì•„ë‚´ê¸° ì–´ë ¤ìš´ ë¬¸ì œë¥¼ ì„ì‹œ íŒŒë¼ë¯¸í„°ë¥¼ ë‘ì–´ í•™ìŠµí•˜ëŠ” ê²ƒì´ë‹¤. ìœ„ ê·¸ë¦¼ì—ì„œ ìš°ë¦¬ëŠ”  pÎ¸(x)ê°€ ë¬´ì—‡ì¸ì§€ ëª¨ë¥´ê¸° ë•Œë¬¸ì—  pÎ¸(z|x)ì„ ì•Œì•„ë‚´ëŠ” ê²ƒì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤. ë”°ë¼ì„œ ì´ì— ê·¼ì‚¬í•œ ê°’ì¸ qÏ†(z|x)(ê²€ì •ìƒ‰ ì ì„ )ì„ ë‘ì–´ posteriorë¥¼ ëŒ€ì‹  ëª¨ë¸ë§ í•˜ë„ë¡ í•œë‹¤.


## 2. 1 Problem scenario
- ë°ì´í„°ì…‹ì´ ìƒì„±ë˜ëŠ” ê³¼ì •ì€ ì•„ë˜ì™€ ê°™ë‹¤.

> 1. ì ì¬ë³€ìˆ˜ zê°€  Prior distribution pÎ¸*ë¡œë¶€í„° ìƒì„±ëœë‹¤.
> 2.  dataset xi ê°€ ì–´ë–¤ conditional distribution pÎ¸*(x|z)ë¡œë¶€í„° ìƒì„±ëœë‹¤.     
          
- í•˜ì§€ë§Œ ë¬¸ì œëŠ” parameter Î¸*ë¥¼ ëª¨ë¥´ê³ , latent variable zë„ ëª¨ë¥¸ë‹¤. (ëª¨ë¸ë§ì´ ì–´ë µë‹¤.)         

- marginal probability p(x) ë¥¼ ì‰½ê²Œ ì´ìš©í•˜ê¸° ìœ„í•œ ê°€ì •ì€ í•˜ì§€ ì•Šì•˜ë‹¤.
> -  marginal likelihoodë¥¼ êµ¬í•  ìˆ˜ ì—†ëŠ” ê²½ìš°ë„ ë™ì‘ ê°€ëŠ¥
> - ë°ì´í„° ì…‹ì´ í° ê²½ìš°ë„ ë™ì‘ ê°€ëŠ¥    

![image](https://user-images.githubusercontent.com/70581043/128817604-cad3a0ed-31ef-4f86-9a0f-ba3da4e569bf.png)
- recognition model qÏ†(z|x)ë¥¼ ë„ì…í•¨   
> - true posterior pÎ¸(z|x)ì— ëŒ€í•œ approximation
> - ì¸ì½”ë” ë¼ê³  ë³¼ ìˆ˜ ë„ ìˆë‹¤.

## 2.2 Variational Bound
![image](https://user-images.githubusercontent.com/70581043/128820419-eb8ac191-704f-489e-9239-f0e9d25701a5.png)
![image](https://user-images.githubusercontent.com/70581043/128826409-8143d5c5-dfa2-4513-ad39-694e8c3c2517.png)

xì— ê´€í•œ marginal likelihood ë¥¼ ìœ„ì™€ ê°™ì´ ì •ì˜í•  ìˆ˜ ìˆë‹¤. ì´ë•Œ DKLê°’ì´ í•­ìƒ non-negativeì´ê¸° ë•Œë¬¸ì— í•´ë‹¹ ì‹ì€ ì•„ë˜ì™€ ê°™ì´ ì“¸ ìˆ˜ë„ ìˆë‹¤.
![image](https://user-images.githubusercontent.com/70581043/128820558-69257ca9-ca5c-4801-8bd0-174f4fe7a891.png)
ìš°ë³€ì„ "variational lower bound" ë¼ê³  ë¶€ë¥¸ë‹¤. ì´ë•Œ  varaiational parameter ì¸ Ï†ì™€ generative parameterì¸  Î¸ ì„ ëª¨ë‘ ìµœì í™”í•˜ê³  ì‹¶ë‹¤.

## 2.3 The SGVB estimator and AEVB algorithm
posteriorë¥¼ ë‹¤ìŒê³¼ ê°™ì´ reparameterize í•œë‹¤. z âˆ¼ qÏ†(z|x)
![image](https://user-images.githubusercontent.com/70581043/128820927-0ca44b9d-3823-4abf-921f-54f3f3c642d4.png)
variational lower bound ì²« ë²ˆì§¸ ì‹(ì¼ë°˜ì ì¸, Stochastic Gradient Variational Bayes estimator)
![image](https://user-images.githubusercontent.com/70581043/128821673-96adab74-bf91-4fb4-95a7-a51db3959023.png)
variational lower bound ë‘ ë²ˆì§¸ ì‹( kl divergenceëŠ”  Ï†ë¥¼ regularization í•˜ëŠ” term)
![image](https://user-images.githubusercontent.com/70581043/128821755-816ac8b5-7fa4-4f45-b68c-fb0547464a51.png)
ì „ì²´ dataset ì— ëŒ€í•œ Lower bound
![image](https://user-images.githubusercontent.com/70581043/128822010-4525c6f2-4133-4762-b9ef-f0aa2e56ec39.png)

## 2.4 The reparametrization trick 
![image](https://user-images.githubusercontent.com/70581043/128825586-a42a95a5-e1fe-42b4-976d-767de77908ee.png)
zë¥¼ í•¨ìˆ˜ gë¡œ í‘œí˜„í•¨ìœ¼ë¡œì¨ (í‰ê· , ë¶„ì‚°)ì— ëŒ€í•´ ë¯¸ë¶„ì´ ê°€ëŠ¥í•˜ê²Œ ë°”ê¾¸ëŠ” íŠ¸ë¦­

## 3. Example : Variational Auto-Encoder 
 loss functionì‹
![image](https://user-images.githubusercontent.com/70581043/128822333-1a75fc68-ea4e-49f1-96d3-7eee281392d7.png)

---
[ì°¸ê³ ìë£Œ] 
- https://judy-son.tistory.com/11
- https://garden-k.medium.com/testing-b3966b642cf5

---
